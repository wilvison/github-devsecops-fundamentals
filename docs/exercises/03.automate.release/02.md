# :test_tube: Implanta√ß√£o Cont√≠nua

<!-- markdownlint-disable MD033 MD036 MD046 -->

!!! quote ":octicons-milestone-16: Entregar valor de alta qualidade com velocidade"

    > Implanta√ß√£o cont√≠nua (CD) √© a pr√°tica de usar automa√ß√£o para publicar e implantar atualiza√ß√µes de software.
    >
    > Para cumprir plenamente nosso objetivo no desenvolvimento completo do recurso, aplicamos em conjunto a pr√°tica de implanta√ß√£o cont√≠nua para validar e entregar valor aos nossos clientes com alta velocidade.

    ![Mostrar marco de implanta√ß√£o cont√≠nua](../../assets/img/milestone-continuous-deployment.png)

---

## Exerc√≠cio: Automatizar Implanta√ß√£o de Lan√ßamentos

O exerc√≠cio anterior nos guiou atrav√©s da automa√ß√£o da publica√ß√£o de lan√ßamentos. Vamos continuar a construir sobre esse marco para automatizar a implanta√ß√£o dos lan√ßamentos publicados.

---

### **:material-numeric-1-circle: Implementar Fluxo de Trabalho de Implanta√ß√£o**

No explorador de arquivos, crie um novo fluxo de trabalho `.github/workflows/continuous.deployment.yml` da seguinte forma:

```yaml title=".github/workflows/continuous.deployment.yml" linenums="1" hl_lines="3-6 8-10 25-27 36-40 42-65 67-71 73-77"
--8<-- "reference.implementations/workflows/3.continuous.deployment.yml"
```

---

#### An√°lise

- **Linhas `3 - 6`**

    As implanta√ß√µes ser√£o acionadas no evento de uma publica√ß√£o de lan√ßamento.

- **Linhas `8 - 10`**

    Garante que apenas um √∫nico trabalho ou fluxo de trabalho usando o mesmo grupo de concorr√™ncia ser√° executado por vez.

    Quando um trabalho ou fluxo de trabalho concorrente √© enfileirado, se outro trabalho ou fluxo de trabalho que usa o mesmo grupo de concorr√™ncia no reposit√≥rio estiver em andamento, o trabalho ou fluxo de trabalho enfileirado ficar√° pendente. Qualquer trabalho ou fluxo de trabalho anteriormente pendente no grupo de concorr√™ncia ser√° cancelado. Se voc√™ n√£o deseja cancelar tamb√©m nenhum trabalho ou fluxo de trabalho em execu√ß√£o no mesmo grupo de concorr√™ncia, especifique `cancel-in-progress: false`.

- **Linhas `25 - 27`**

    Isso far√° com que a URL do site implantado seja exibida onde o fluxo de trabalho √© executado.

- **Linhas `36 - 40`**

    Esta etapa habilita o [GitHub Pages](https://docs.github.com/pt/pages/getting-started-with-github-pages/about-github-pages) e extrai v√°rios metadados sobre um site. Ela tamb√©m pode ser usada para configurar v√°rios geradores de sites est√°ticos que suportamos como fluxos de trabalho iniciais.

- **Linhas `42 - 65`**

    Baixa os ativos associados √† publica√ß√£o de lan√ßamento que acionou este fluxo de trabalho e, quando necess√°rio, ajusta as permiss√µes para os arquivos nos ativos.

- **Linhas `67 - 71`**

    Carrega os artefatos do site para o local de armazenamento onde devem ser finalmente coletados pela pr√≥xima etapa para implanta√ß√£o.

- **Linhas `73 - 77`**

    Esta etapa implanta o site.

---

### **:material-numeric-2-circle: Fazer commit e publicar suas altera√ß√µes**

!!! tip "Voc√™ pode vincular suas altera√ß√µes a uma issue"

    Lembre-se da issue que voc√™ criou anteriormente e seu respectivo n√∫mero, voc√™ o usar√° para vincular suas altera√ß√µes atuais √† issue.

```bash linenums="1"
git add .
git commit -m "$(printf 'Criar um jogo de tetris para impulsionar o engajamento do site\n\n-Implementar implanta√ß√£o cont√≠nua\n\n- Resolve #<N√öMERO-DA-ISSUE>')"
git push origin feature/tetris-game
```

---

### **:material-numeric-3-circle: Mesclar seu pull request aberto**

- Na p√°gina do pull request, abra o menu suspenso do bot√£o <span class="gh-button-green">Mesclar pull request <span class="gh-button-green-with-dropdown">:material-menu-down:</span></span> para escolher a op√ß√£o **Rebase e mesclar**.

- Em seguida, pressione o bot√£o <span class="gh-button-green">Rebase e mesclar <span class="gh-button-green-with-dropdown">:material-menu-down:</span></span> para mesclar seu pull request.

    ![Mostrar visualiza√ß√£o de mesclagem do pull request](../../assets/img/merge-pull-request.png){ style="width: 25em;" }

- Finalmente, pressione <span class="gh-button-green">Confirmar rebase e mesclagem</span>.

Quando voc√™ mescla o pull request aberto, deve fazer as seguintes observa√ß√µes.

{==

**Colabora√ß√£o**

- A issue vinculada em seu quadro de projeto √© automaticamente fechada e movida para a coluna **‚úÖ Conclu√≠do** do quadro.

    ![Mostrar item de trabalho conclu√≠do](../../assets/img/issue-closed-done.png){ style="width: 25em;" }

**Automa√ß√£o**

Quando voc√™ vai para a aba **:octicons-play-16: Actions** em seu reposit√≥rio, e observa...

- O fluxo de trabalho `Version Changes to the Main Branch` √© executado.
- O fluxo de trabalho `Package Delivery Artifacts & Create Release` √© executado.

    Consequentemente, o lan√ßamento √© anunciado em **:octicons-comment-discussion-16: Discuss√µes**.
    ![Mostrar discuss√£o de lan√ßamento](../../assets/img/release-discussions.png){ style="width: 25em;" }

- O fluxo de trabalho `Deploy Release` √© executado.

    E na conclus√£o bem-sucedida do fluxo de trabalho, a URL p√∫blica do seu site √© exibida no trabalho.

    ![Mostrar execu√ß√£o bem-sucedida de implanta√ß√£o de lan√ßamento](../../assets/img/successful-deployment-job.png){ style="width: 25em;" }

**Capacita√ß√£o de Partes Interessadas**

As partes interessadas podem facilmente explorar implanta√ß√µes do projeto.

- Resumo de implanta√ß√µes na p√°gina inicial do reposit√≥rio.

    ![Mostrar implanta√ß√£o na p√°gina inicial do reposit√≥rio](../../assets/img/deployments-view-on-repo-home.png){ style="width: 25em;" }

- Lista detalhada de ambientes de implanta√ß√£o.

    ![Mostrar lista de implanta√ß√µes](../../assets/img/deployments-list.png){ style="width: 25em;" }

==}

---

## üìö Recursos

- [Usando ambientes para implanta√ß√£o](https://docs.github.com/pt/actions/deployment/targeting-different-environments/using-environments-for-deployment)
- [Criando regras de prote√ß√£o de implanta√ß√£o personalizadas](https://docs.github.com/pt/actions/deployment/protecting-deployments/creating-custom-deployment-protection-rules)
- [Fortalecimento de seguran√ßa de implanta√ß√µes com OpenID Connect](https://docs.github.com/pt/actions/deployment/security-hardening-your-deployments/about-security-hardening-with-openid-connect)

---
